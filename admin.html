<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Video YÃ¶netim Paneli</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { font-family: sans-serif; background: #f4f4f4; padding: 20px; }
        .container { max-width: 800px; margin: auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        input { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        button { padding: 10px 20px; cursor: pointer; border: none; border-radius: 5px; font-weight: bold; }
        .btn-save { background: #28a745; color: white; width: 100%; }
        .btn-edit { background: #ffc107; color: black; margin-right: 5px; }
        .btn-delete { background: #dc3545; color: white; }
        table { width: 100%; margin-top: 20px; border-collapse: collapse; }
        th, td { border-bottom: 1px solid #ddd; padding: 10px; text-align: left; }
        .password-badge { background: #eee; padding: 2px 5px; border-radius: 3px; font-size: 12px; }
    </style>
</head>
<body>

<div class="container">
    <h2>Video Ekle / DÃ¼zenle</h2>
    <input type="hidden" id="editId">
    <input type="text" id="title" placeholder="Video BaÅŸlÄ±ÄŸÄ± (Ã–rn: Film AdÄ±)">
    <input type="text" id="v_url" placeholder="Video URL (YouTube veya MP4 Linki)">
    <input type="text" id="a_url" placeholder="Ses DosyasÄ± URL (Ä°steÄŸe BaÄŸlÄ±)">
    <input type="text" id="password" placeholder="Video Åžifresi (Åžifresiz olmasÄ± iÃ§in boÅŸ bÄ±rakÄ±n)">
    <button class="btn-save" onclick="saveData()">VERÄ°YÄ° KAYDET</button>

    <h3>KÃ¼tÃ¼phane</h3>
    <table id="videoTable">
        <thead>
            <tr>
                <th>BaÅŸlÄ±k</th>
                <th>Åžifre</th>
                <th>Ä°ÅŸlemler</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script>
    const config = {
        apiKey: "AIzaSyDVS-jg8FkE9xuUfzlnYboKrqsHHTL3Bvo",
        databaseURL: "https://naberdeneme-ffa04-default-rtdb.firebaseio.com",
        projectId: "naberdeneme-ffa04"
    };
    firebase.initializeApp(config);
    const db = firebase.database();

    function saveData() {
        const id = document.getElementById('editId').value;
        const data = {
            title: document.getElementById('title').value,
            v_url: document.getElementById('v_url').value,
            a_url: document.getElementById('a_url').value || "", // BoÅŸ olabilir
            password: document.getElementById('password').value || "" // BoÅŸ olabilir
        };

        if(!data.title || !data.v_url) return alert("BaÅŸlÄ±k ve Video URL zorunludur!");

        if(id) {
            db.ref('videolar/' + id).set(data).then(() => resetForm());
        } else {
            db.ref('videolar').push(data).then(() => resetForm());
        }
    }

    function resetForm() {
        document.getElementById('editId').value = "";
        document.getElementById('title').value = "";
        document.getElementById('v_url').value = "";
        document.getElementById('a_url').value = "";
        document.getElementById('password').value = "";
        alert("BaÅŸarÄ±yla kaydedildi.");
    }

    // Listeleme
    db.ref('videolar').on('value', snap => {
        const tbody = document.querySelector('#videoTable tbody');
        tbody.innerHTML = "";
        snap.forEach(child => {
            const v = child.val();
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${v.title}</td>
                <td>${v.password ? '<span class="password-badge">ðŸ”’ '+v.password+'</span>' : 'ðŸ”“ Yok'}</td>
                <td>
                    <button class="btn-edit" onclick="editData('${child.key}')">DÃ¼zenle</button>
                    <button class="btn-delete" onclick="deleteData('${child.key}')">Sil</button>
                </td>
            `;
            tbody.appendChild(tr);
        });
    });

    function editData(key) {
        db.ref('videolar/' + key).once('value', snap => {
            const v = snap.val();
            document.getElementById('editId').value = key;
            document.getElementById('title').value = v.title;
            document.getElementById('v_url').value = v.v_url;
            document.getElementById('a_url').value = v.a_url;
            document.getElementById('password').value = v.password || "";
            window.scrollTo(0,0);
        });
    }

    function deleteData(key) {
        if(confirm("Bu videoyu silmek istediÄŸinize emin misiniz?")) {
            db.ref('videolar/' + key).remove();
        }
    }
</script>
</body>
    </html>
