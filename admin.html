<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Süper Admin Paneli</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; margin: 0; padding: 20px; }
        .container { max-width: 900px; margin: auto; }
        .box { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 20px; }
        input { padding: 12px; margin: 5px; border: 1px solid #ddd; border-radius: 8px; width: calc(100% - 30px); }
        .row { display: flex; gap: 10px; }
        button { padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .btn-add { background: #1a73e8; color: white; width: 100%; margin-top: 10px; }
        .btn-del { background: #d93025; color: white; padding: 5px 10px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { text-align: left; padding: 12px; border-bottom: 1px solid #eee; }
        #login-ui { position: fixed; inset: 0; background: #f0f2f5; display: flex; align-items: center; justify-content: center; z-index: 100; }
    </style>
</head>
<body>

<div id="login-ui">
    <div class="box" style="width: 350px;">
        <h2>Admin Girişi</h2>
        <input type="email" id="email" placeholder="E-posta">
        <input type="password" id="pass" placeholder="Şifre">
        <button class="btn-add" onclick="login()">GİRİŞ YAP</button>
    </div>
</div>

<div class="container" id="admin-content" style="display:none;">
    <div class="box">
        <h2>Yeni Video Ekle</h2>
        <input type="text" id="v_title" placeholder="Video Başlığı">
        <input type="text" id="v_url" placeholder="YouTube Link">
        <input type="text" id="v_pin" placeholder="İzleme Şifresi (İsteğe bağlı)">
        <button class="btn-add" onclick="save()">SİSTEME KAYDET</button>
    </div>

    <div class="box">
        <h2>Ekli Videolar</h2>
        <table id="video-table">
            <thead>
                <tr>
                    <th>Başlık</th>
                    <th>Şifre</th>
                    <th>İşlem</th>
                </tr>
            </thead>
            <tbody id="v-list"></tbody>
        </table>
    </div>
</div>

<script>
    const config = {
        apiKey: "AIzaSyDVS-jg8FkE9xuUfzlnYboKrqsHHTL3Bvo",
        authDomain: "naberdeneme-ffa04.firebaseapp.com",
        databaseURL: "https://naberdeneme-ffa04-default-rtdb.firebaseio.com",
        projectId: "naberdeneme-ffa04"
    };
    firebase.initializeApp(config);
    const auth = firebase.auth();
    const db = firebase.database();

    const targetUID = "mKgAps2wiLUyvcRMXAD93QRDovV2";

    function login() {
        const e = document.getElementById('email').value;
        const p = document.getElementById('pass').value;
        auth.signInWithEmailAndPassword(e, p).catch(err => alert(err.message));
    }

    auth.onAuthStateChanged(user => {
        if (user && user.uid === targetUID) {
            document.getElementById('login-ui').style.display = 'none';
            document.getElementById('admin-content').style.display = 'block';
            loadVideos();
        } else if (user) {
            auth.signOut();
            alert("Yetkisiz kullanıcı!");
        }
    });

    function save() {
        const title = document.getElementById('v_title').value;
        let url = document.getElementById('v_url').value;
        const pin = document.getElementById('v_pin').value;

        if(!title || !url) return;

        if(url.includes("watch?v=")) url = url.replace("watch?v=", "embed/");
        if(url.includes("youtu.be/")) url = url.replace("youtu.be/", "youtube.com/embed/");

        db.ref('videolar').push({ title, url, pin: pin || "" })
        .then(() => {
            document.getElementById('v_title').value = "";
            document.getElementById('v_url').value = "";
            document.getElementById('v_pin').value = "";
        });
    }

    function loadVideos() {
        db.ref('videolar').on('value', snap => {
            const list = document.getElementById('v-list');
            list.innerHTML = "";
            snap.forEach(child => {
                const v = child.val();
                list.innerHTML += `
                    <tr>
                        <td>${v.title}</td>
                        <td>${v.pin || '-'}</td>
                        <td><button class="btn-del" onclick="remove('${child.key}')">Sil</button></td>
                    </tr>
                `;
            });
        });
    }

    function remove(key) {
        if(confirm("Bu videoyu silmek istediğine emin misin?")) {
            db.ref('videolar').child(key).remove();
        }
    }
</script>
</body>
</html>
