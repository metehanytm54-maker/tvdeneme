<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TV Arşiv - Full Screen</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        /* Ekranın hiçbir yerinde boşluk kalmaması için */
        html, body { 
            margin: 0; 
            padding: 0; 
            width: 100%; 
            height: 100%; 
            background: #000; 
            overflow: hidden; 
            font-family: Arial, sans-serif;
        }

        h1 { color: white; padding: 20px; margin: 0; font-size: 24px; border-bottom: 2px solid #e50914; }

        .grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); 
            gap: 20px; 
            padding: 20px; 
            box-sizing: border-box;
        }

        .card { 
            background: #141414; 
            border-radius: 8px; 
            border: 4px solid transparent; 
            cursor: pointer; 
            color: white;
            transition: 0.2s;
        }

        /* Kumanda ile üzerine gelince yanan çerçeve */
        .card:focus { 
            border-color: #fff; 
            transform: scale(1.05); 
            outline: none; 
        }

        .card-img { height: 140px; background: #333; display: flex; align-items: center; justify-content: center; font-size: 50px; color: #e50914; }
        .card-title { padding: 10px; font-weight: bold; text-align: center; }

        /* VİDEO OYNATICI - TÜM EKRANI KAPLAR */
        #player { 
            display: none; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100vw; 
            height: 100vh; 
            background: black; 
            z-index: 9999; 
        }

        /* Iframe'i ekranın her köşesine zorla yayar */
        iframe { 
            position: absolute;
            top: 0;
            left: 0;
            width: 100% !important; 
            height: 100% !important; 
            border: none; 
        }

        /* Kapat butonu - TV'de görünmesi için sağ üste belirgin koyduk */
        .back-btn { 
            position: absolute; 
            top: 15px; 
            right: 15px; 
            background: rgba(229, 9, 20, 0.8); 
            color: white; 
            padding: 10px 20px; 
            border-radius: 5px; 
            border: none; 
            font-size: 16px; 
            font-weight: bold; 
            z-index: 10000; 
            cursor: pointer;
        }
    </style>
</head>
<body>

    <div id="ui-wrapper">
        <h1>VİDEO ARŞİVİ</h1>
        <div class="grid" id="video-list">Yükleniyor...</div>
    </div>

    <div id="player">
        <button class="back-btn" onclick="closePlayer()">GERİ DÖN (Kapat)</button>
        <div id="video-content" style="width:100%; height:100%;"></div>
    </div>

    <script>
        const config = {
            apiKey: "AIzaSyDVS-jg8FkE9xuUfzlnYboKrqsHHTL3Bvo",
            databaseURL: "https://naberdeneme-ffa04-default-rtdb.firebaseio.com",
            projectId: "naberdeneme-ffa04"
        };
        firebase.initializeApp(config);

        firebase.database().ref('videolar').on('value', (snapshot) => {
            const list = document.getElementById('video-list');
            list.innerHTML = "";
            const data = snapshot.val();
            
            if(data) {
                for(let id in data) {
                    const v = data[id];
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.tabIndex = "0"; 
                    card.innerHTML = `<div class="card-img">▶</div><div class="card-title">${v.title}</div>`;
                    card.onclick = () => openPlayer(v.url);
                    card.onkeydown = (e) => { if(e.keyCode === 13) openPlayer(v.url); };
                    list.appendChild(card);
                }
            } else {
                list.innerHTML = "<p style='color:white'>Video bulunamadı.</p>";
            }
        });

        function openPlayer(url) {
            const player = document.getElementById('player');
            const content = document.getElementById('video-content');
            
            player.style.display = 'block';
            
            // TV için en önemli ayar: iv_load_policy=3 (reklamları/bilgileri azaltır) 
            // ve allow="autoplay; encrypted-media"
            content.innerHTML = `<iframe 
                src="${url}?autoplay=1&rel=0&controls=1&showinfo=0&iv_load_policy=3&fs=1" 
                allow="autoplay; fullscreen; encrypted-media" 
                frameborder="0"
                allowfullscreen></iframe>`;
            
            // TV'nin odağını butonun üzerine alalım (Geri dönebilmek için)
            document.querySelector('.back-btn').focus();
        }

        function closePlayer() {
            document.getElementById('player').style.display = 'none';
            document.getElementById('video-content').innerHTML = "";
        }
    </script>
</body>
</html>
